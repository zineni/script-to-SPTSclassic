-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")

local plr = Players.LocalPlayer

-- ---------- Utility: safely get text value (part after ':') ----------
local function getValueFromTextObject(textObject)
    if not textObject then return "N/A" end
    local ok, res = pcall(function()
        local text = tostring(textObject.Text or "")
        local found = string.match(text, ":%s*(.+)$")
        if found then
            return found
        else
            local last = string.match(text, "([^%s]+)$")
            return last or text
        end
    end)
    return ok and res or "N/A"
end

-- ---------- Parser: convert strings like "1.2K" -> number ----------
local function parseStatValue(valueStr)
    if not valueStr then return 0 end
    if valueStr == "N/A" then return 0 end
    local s = tostring(valueStr):gsub("%s+", ""):lower()
    local asnum = tonumber(s)
    if asnum then return asnum end
    local multipliers = {
        k = 1e3,
        m = 1e6,
        b = 1e9,
        t = 1e12
    }
    local numPart, suffix = string.match(s, "^([%d%.]+)%s*([kmgt]?)$")
    if numPart then
        local n = tonumber(numPart) or 0
        if suffix and suffix ~= "" then
            local mult = multipliers[suffix] or 1
            return n * mult
        else
            return n
        end
    end
    local raw = tonumber(string.match(s, "[%d%.]+") or "0") or 0
    return raw
end

-- ---------- Formatting numbers into K/M/B/T ----------
local function formatNumberShort(num)
    num = num or 0
    local absNum = math.abs(num)
    if absNum >= 1e12 then
        return string.format("%.2fT", num / 1e12)
    elseif absNum >= 1e9 then
        return string.format("%.2fB", num / 1e9)
    elseif absNum >= 1e6 then
        return string.format("%.2fM", num / 1e6)
    elseif absNum >= 1e3 then
        return string.format("%.2fK", num / 1e3)
    else
        return tostring(math.floor(num))
    end
end

-- ---------- Getters for specific stats ----------
local function safeGetGui(pathFunc)
    local ok, res = pcall(pathFunc)
    return ok and res or nil
end

local function getFistStrengthText()
    local obj = safeGetGui(function() return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.FSTxt end)
    return getValueFromTextObject(obj)
end

local function getPsychicPowerText()
    local obj = safeGetGui(function() return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.PPTxt end)
    return getValueFromTextObject(obj)
end

local function getJumpForceText()
    local obj = safeGetGui(function() return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.JFTxt end)
    return getValueFromTextObject(obj)
end

local function getMovementSpeedText()
    local obj = safeGetGui(function() return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.MSTxt end)
    return getValueFromTextObject(obj)
end

local function getBodyToughnessText()
    local obj = safeGetGui(function() return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.BTTxt end)
    return getValueFromTextObject(obj)
end

local function getAllStatsText()
    return {
        FistStrength = getFistStrengthText(),
        PsychicPower = getPsychicPowerText(),
        JumpForce = getJumpForceText(),
        MovementSpeed = getMovementSpeedText(),
        BodyToughness = getBodyToughnessText()
    }
end

-- ---------- Format difference (only difference + color) ----------
local function formatDifference(startValStr, endValStr)
    local startNum = parseStatValue(startValStr)
    local endNum = parseStatValue(endValStr)
    local diff = endNum - startNum
    if diff == 0 then
        return "0", Color3.new(1,1,1)
    elseif diff > 0 then
        return "+" .. formatNumberShort(diff), Color3.new(0,1,0)
    else
        return formatNumberShort(diff), Color3.new(1,0,0)
    end
end

-- ==============================
-- === Stats GUI (–≤–∞—à —Å—Ç–∏–ª—å) ===
-- ==============================
local function createStatsGUI()
    if plr.PlayerGui:FindFirstChild("StatsGUI") then
        plr.PlayerGui.StatsGUI:Destroy()
    end

    local StatsGUI = Instance.new("ScreenGui")
    StatsGUI.Name = "StatsGUI"
    StatsGUI.Parent = plr.PlayerGui
    StatsGUI.ResetOnSpawn = false

    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 300, 0, 350)
    MainFrame.Position = UDim2.new(0.5, -150, 0.5, -175)
    MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.15
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = StatsGUI
    MainFrame.Visible = false

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = MainFrame
    UICorner.CornerRadius = UDim.new(0, 12)

    -- –¢–µ–Ω—å/–æ–±–≤–æ–¥–∫–∞
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Parent = MainFrame
    UIStroke.Color = Color3.new(1, 1, 1)
    UIStroke.Thickness = 2
    UIStroke.Transparency = 0.7

    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, 0, 0, 50)
    TitleLabel.Position = UDim2.new(0, 0, 0, 0)
    TitleLabel.BackgroundColor3 = Color3.new(0, 0, 0)
    TitleLabel.BackgroundTransparency = 0.3
    TitleLabel.Text = "–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ì–†–û–ö–ê"
    TitleLabel.TextColor3 = Color3.new(1, 1, 1)
    TitleLabel.TextSize = 18
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.BorderSizePixel = 0
    TitleLabel.Parent = MainFrame

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.Parent = TitleLabel
    TitleCorner.CornerRadius = UDim.new(0, 12)

    -- –ò–º—è –∏–≥—Ä–æ–∫–∞
    local PlayerName = Instance.new("TextLabel")
    PlayerName.Size = UDim2.new(1, -20, 0, 30)
    PlayerName.Position = UDim2.new(0, 10, 0, 55)
    PlayerName.BackgroundTransparency = 1
    PlayerName.Text = "–ò–≥—Ä–æ–∫: " .. (plr and plr.Name or "Player")
    PlayerName.TextColor3 = Color3.new(1, 1, 1)
    PlayerName.TextSize = 16
    PlayerName.TextXAlignment = Enum.TextXAlignment.Left
    PlayerName.Font = Enum.Font.Gotham
    PlayerName.Parent = MainFrame

    -- –õ–∏–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    local Divider = Instance.new("Frame")
    Divider.Size = UDim2.new(1, -20, 0, 1)
    Divider.Position = UDim2.new(0, 10, 0, 90)
    Divider.BackgroundColor3 = Color3.new(1, 1, 1)
    Divider.BackgroundTransparency = 0.7
    Divider.BorderSizePixel = 0
    Divider.Parent = MainFrame

    -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    local StatsContainer = Instance.new("Frame")
    StatsContainer.Size = UDim2.new(1, -20, 0, 200)
    StatsContainer.Position = UDim2.new(0, 10, 0, 100)
    StatsContainer.BackgroundTransparency = 1
    StatsContainer.BorderSizePixel = 0
    StatsContainer.Parent = MainFrame

    local function createRow(y, labelText, valueText)
        local rowFrame = Instance.new("Frame")
        rowFrame.Size = UDim2.new(1, 0, 0, 30)
        rowFrame.Position = UDim2.new(0, 0, 0, y)
        rowFrame.BackgroundTransparency = 1
        rowFrame.BorderSizePixel = 0
        rowFrame.Parent = StatsContainer

        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(0.6, 0, 1, 0)
        nameLabel.Position = UDim2.new(0, 0, 0, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = labelText
        nameLabel.TextColor3 = Color3.new(1, 1, 1)
        nameLabel.TextSize = 14
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.Parent = rowFrame

        local valueLabel = Instance.new("TextLabel")
        valueLabel.Size = UDim2.new(0.4, 0, 1, 0)
        valueLabel.Position = UDim2.new(0.6, 0, 0, 0)
        valueLabel.BackgroundTransparency = 1
        valueLabel.Text = valueText or "N/A"
        valueLabel.TextColor3 = Color3.new(1, 1, 1)
        valueLabel.TextSize = 14
        valueLabel.TextXAlignment = Enum.TextXAlignment.Right
        valueLabel.Font = Enum.Font.GothamBold
        valueLabel.Parent = rowFrame

        return valueLabel
    end

    local fsValue = createRow(0, "Fist Strength", getFistStrengthText())
    local ppValue = createRow(35, "Psychic Power", getPsychicPowerText())
    local jfValue = createRow(70, "Jump Force", getJumpForceText())
    local msValue = createRow(105, "Movement Speed", getMovementSpeedText())
    local btValue = createRow(140, "Body Toughness", getBodyToughnessText())

    -- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(1, -20, 0, 40)
    CloseButton.Position = UDim2.new(0, 10, 1, -50)
    CloseButton.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
    CloseButton.BackgroundTransparency = 0.2
    CloseButton.Text = "–ó–ê–ö–†–´–¢–¨"
    CloseButton.TextColor3 = Color3.new(1, 1, 1)
    CloseButton.TextSize = 16
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.BorderSizePixel = 0
    CloseButton.Parent = MainFrame

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.Parent = CloseButton
    ButtonCorner.CornerRadius = UDim.new(0, 8)

    -- –û–±–≤–æ–¥–∫–∞ –∫–Ω–æ–ø–∫–∏
    local ButtonStroke = Instance.new("UIStroke")
    ButtonStroke.Parent = CloseButton
    ButtonStroke.Color = Color3.new(1, 1, 1)
    ButtonStroke.Thickness = 1.5
    ButtonStroke.Transparency = 0.5

    -- –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    local function updateStats()
        fsValue.Text = getFistStrengthText()
        ppValue.Text = getPsychicPowerText()
        jfValue.Text = getJumpForceText()
        msValue.Text = getMovementSpeedText()
        btValue.Text = getBodyToughnessText()
    end

    -- –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏
    local function toggleStatsPanel()
        if MainFrame.Visible then
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Position = UDim2.new(0.5, -150, 0.5, -175),
                Size = UDim2.new(0, 0, 0, 0)
            })
            tween:Play()
            tween.Completed:Wait()
            MainFrame.Visible = false
        else
            updateStats()
            MainFrame.Visible = true
            MainFrame.Size = UDim2.new(0, 0, 0, 0)
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 300, 0, 350),
                Position = UDim2.new(0.5, -150, 0.5, -175)
            })
            tween:Play()
        end
    end

    CloseButton.MouseButton1Click:Connect(toggleStatsPanel)

    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ —Ñ—Ä–µ–π–º–∞
    local function setupClickOutside()
        local background = Instance.new("TextButton")
        background.Parent = StatsGUI
        background.Size = UDim2.new(1, 0, 1, 0)
        background.Position = UDim2.new(0, 0, 0, 0)
        background.BackgroundTransparency = 1
        background.Text = ""
        background.Visible = false
        
        background.MouseButton1Click:Connect(function()
            if MainFrame.Visible then
                toggleStatsPanel()
            end
        end)
        
        MainFrame:GetPropertyChangedSignal("Visible"):Connect(function()
            background.Visible = MainFrame.Visible
        end)
    end

    setupClickOutside()

    -- –ê–≤—Ç–æ-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    spawn(function()
        while true do
            wait(5)
            if MainFrame and MainFrame.Visible then
                pcall(updateStats)
            end
        end
    end)

    return {
        toggle = toggleStatsPanel,
        update = updateStats,
        gui = StatsGUI
    }
end

-- ==============================
-- ==============================
-- === ESP System with Teleport ===
-- ==============================
local function createESPSystem(commandConsole)
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local TweenService = game:GetService("TweenService")
    local plr = Players.LocalPlayer
    
    -- –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è)
    local function showOutput(text)
        if commandConsole and commandConsole.showOutput then
            commandConsole.showOutput(text)
        else
            -- –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å
            print("[ESP]: " .. tostring(text))
        end
    end
    
    -- –¢–∞–±–ª–∏—Ü—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ESP —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    local espFolders = {}
    local espConnections = {}
    local espEnabled = false
    
    -- –°–æ–∑–¥–∞–µ–º GUI –¥–ª—è ESP
    local ESPGui = Instance.new("ScreenGui")
    ESPGui.Name = "ESPGui"
    ESPGui.Parent = plr.PlayerGui
    ESPGui.ResetOnSpawn = false
    
    -- –§—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
    local function safeTeleportTo(cf)
        local char = plr.Character
        if not char then return false end
        
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return false end
        
        local success = pcall(function()
            hrp.CFrame = cf
        end)
        
        return success
    end
    
    -- –§—É–Ω–∫—Ü–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –∫ –∏–≥—Ä–æ–∫—É
    local function teleportToPlayer(targetPlayer)
        local targetChar = targetPlayer.Character
        if not targetChar then
            showOutput("‚ùå –ò–≥—Ä–æ–∫ " .. targetPlayer.Name .. " –Ω–µ –∏–º–µ–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞")
            return
        end
        
        local targetHrp = targetChar:FindFirstChild("HumanoidRootPart")
        if not targetHrp then
            showOutput("‚ùå –ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ HumanoidRootPart —É " .. targetPlayer.Name)
            return
        end
        
        -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç —Ü–µ–ª–∏
        local targetCFrame = targetHrp.CFrame + targetHrp.CFrame.LookVector * -8 + Vector3.new(0, 3, 0)
        
        if safeTeleportTo(targetCFrame) then
            showOutput("üéØ –¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫ –∏–≥—Ä–æ–∫—É: " .. targetPlayer.Name)
        else
            showOutput("‚ùå –û—à–∏–±–∫–∞ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏ –∫ " .. targetPlayer.Name)
        end
    end
    
    -- –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è ESP –¥–ª—è –∏–≥—Ä–æ–∫–∞
    local function createESP(player)
        if player == plr then return end -- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–±—è
        
        local character = player.Character
        if not character then return end
        
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoidRootPart or not humanoid then return end
        
        -- –°–æ–∑–¥–∞–µ–º folder –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ESP —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
        local espFolder = Instance.new("Folder")
        espFolder.Name = player.Name
        espFolder.Parent = ESPGui
        espFolders[player] = espFolder
        
        -- –°–æ–∑–¥–∞–µ–º BillboardGui –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "ESP"
        billboard.Size = UDim2.new(0, 100, 0, 25)
        billboard.ExtentsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Enabled = true
        billboard.Active = true 
        billboard.Parent = espFolder
        
        -- –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ –≥–æ–ª–æ–≤–µ –∏–≥—Ä–æ–∫–∞
        local head = character:FindFirstChild("Head")
        if head then
            billboard.Adornee = head
        else
            billboard.Adornee = humanoidRootPart
        end
        
        -- –§–æ–Ω –¥–ª—è –∏–º–µ–Ω–∏
        local nameBackground = Instance.new("Frame")
        nameBackground.Name = "Background"
        nameBackground.Size = UDim2.new(1, 0, 0, 25)
        nameBackground.Position = UDim2.new(0, 0, 0, 0)
        nameBackground.BackgroundColor3 = Color3.new(0, 0, 0)
        nameBackground.BackgroundTransparency = 0.3
        nameBackground.BorderSizePixel = 0
        nameBackground.Parent = billboard
        
        -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞
        local corner = Instance.new("UICorner")
        corner.CornerRadius = UDim.new(0, 8)
        corner.Parent = nameBackground
        
        -- –û–±–≤–æ–¥–∫–∞
        local stroke = Instance.new("UIStroke")
        stroke.Color = Color3.new(1, 1, 1)
        stroke.Thickness = 1
        stroke.Transparency = 0.5
        stroke.Parent = nameBackground
        
        -- –¢–µ–∫—Å—Ç —Å –∏–º–µ–Ω–µ–º –∏–≥—Ä–æ–∫–∞ (–ö–õ–ò–ö–ê–ë–ï–õ–¨–ù–´–ô)
        local nameLabel = Instance.new("TextButton")
        nameLabel.Name = "NameLabel"
        nameLabel.Size = UDim2.new(1, 0, 1, 0)
        nameLabel.Position = UDim2.new(0, 0, 0, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.TextColor3 = Color3.new(1, 1, 1)
        nameLabel.TextSize = 14
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextWrapped = true
        nameLabel.AutoButtonColor = false 
        nameLabel.Active = true 
        nameLabel.Parent = nameBackground
        
        -- –î–∏—Å—Ç–∞–Ω—Ü–∏—è –ø–æ–¥ –∏–º–µ–Ω–µ–º
        local distanceLabel = Instance.new("TextLabel")
        distanceLabel.Name = "DistanceLabel"
        distanceLabel.Size = UDim2.new(1, 0, 0, 15)
        distanceLabel.Position = UDim2.new(0, 0, 0, 25)
        distanceLabel.BackgroundTransparency = 1
        distanceLabel.Text = "0 studs"
        distanceLabel.TextColor3 = Color3.new(0.8, 0.8, 0.8)
        distanceLabel.TextSize = 10
        distanceLabel.Font = Enum.Font.Gotham
        distanceLabel.Parent = billboard
        
        -- –û–ë–†–ê–ë–û–¢–ß–ò–ö –ö–õ–ò–ö–ê –î–õ–Ø –¢–ï–õ–ï–ü–û–†–¢–ê–¶–ò–ò
        nameLabel.MouseButton1Click:Connect(function()
            showOutput("üîÑ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –∫ " .. player.Name .. "...")
            teleportToPlayer(player)
        end)
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ (–≤–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)
        nameLabel.MouseEnter:Connect(function()
            local tween = TweenService:Create(nameBackground, TweenInfo.new(0.2), {
                BackgroundTransparency = 0.1,
                BackgroundColor3 = Color3.new(0.1, 0.3, 0.1) -- –ó–µ–ª–µ–Ω—ã–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
            })
            tween:Play()
            
            local textTween = TweenService:Create(nameLabel, TweenInfo.new(0.2), {
                TextColor3 = Color3.new(0, 1, 0) -- –Ø—Ä–∫–æ-–∑–µ–ª–µ–Ω—ã–π —Ç–µ–∫—Å—Ç
            })
            textTween:Play()
        end)
        
        nameLabel.MouseLeave:Connect(function()
            local tween = TweenService:Create(nameBackground, TweenInfo.new(0.2), {
                BackgroundTransparency = 0.3,
                BackgroundColor3 = Color3.new(0, 0, 0) -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º —á–µ—Ä–Ω—ã–π
            })
            tween:Play()
            
            local textTween = TweenService:Create(nameLabel, TweenInfo.new(0.2), {
                TextColor3 = Color3.new(1, 1, 1) -- –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç
            })
            textTween:Play()
        end)
        
        -- –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
        local function updateDistance()
            if not espEnabled then return end
            
            local localChar = plr.Character
            local localHrp = localChar and localChar:FindFirstChild("HumanoidRootPart")
            local targetHrp = character:FindFirstChild("HumanoidRootPart")
            
            if localHrp and targetHrp and humanoid.Health > 0 then
                local distance = (localHrp.Position - targetHrp.Position).Magnitude
                distanceLabel.Text = string.format("%.0f studs", distance)
                
                -- –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
                if distance < 20 then
                    nameLabel.TextColor3 = Color3.new(1, 0.2, 0.2) -- –ö—Ä–∞—Å–Ω—ã–π (–±–ª–∏–∑–∫–æ)
                elseif distance < 50 then
                    nameLabel.TextColor3 = Color3.new(1, 0.8, 0.2) -- –û—Ä–∞–Ω–∂–µ–≤—ã–π
                else
                    nameLabel.TextColor3 = Color3.new(0.2, 1, 0.2) -- –ó–µ–ª–µ–Ω—ã–π (–¥–∞–ª–µ–∫–æ)
                end
            else
                distanceLabel.Text = "N/A"
            end
        end
        
        -- –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
        local distanceConnection = RunService.Heartbeat:Connect(updateDistance)
        table.insert(espConnections, distanceConnection)

        local scale = math.clamp(1 / (distance / 30), 0.33, 1)
        billboard.Size = UDim2.new(0, 200 * scale, 0, 50 * scale)
    end
    
    -- –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è ESP –∏–≥—Ä–æ–∫–∞
    local function removeESP(player)
        if espFolders[player] then
            espFolders[player]:Destroy()
            espFolders[player] = nil
        end
    end
    
    -- –§—É–Ω–∫—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∏—è ESP
    local function enableESP()
        if espEnabled then 
            showOutput("üëÅÔ∏è ESP: —É–∂–µ –≤–∫–ª—é—á–µ–Ω")
            return 
        end
        
        espEnabled = true
        showOutput("üëÅÔ∏è ESP: –≤–∫–ª—é—á–µ–Ω - –∫–ª–∏–∫–∞–π—Ç–µ –Ω–∞ –∏–º–µ–Ω–∞ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏!")
        
        -- –°–æ–∑–¥–∞–µ–º ESP –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–≥—Ä–æ–∫–æ–≤
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= plr then
                pcall(createESP, player)
            end
        end
        
        -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
        local playerAddedConnection = Players.PlayerAdded:Connect(function(player)
            if espEnabled then
                pcall(function() createESP(player) end)
            end
        end)
        table.insert(espConnections, playerAddedConnection)
        
        -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—ã—à–µ–¥—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤
        local playerRemovingConnection = Players.PlayerRemoving:Connect(function(player)
            pcall(function() removeESP(player) end)
        end)
        table.insert(espConnections, playerRemovingConnection)
        
        -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ä–µ—Å–ø–∞–≤–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        local characterAddedConnection = plr.CharacterAdded:Connect(function()
            -- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º ESP –ø—Ä–∏ —Ä–µ—Å–ø–∞–≤–Ω–µ
            if espEnabled then
                for _, player in ipairs(Players:GetPlayers()) do
                    if player ~= plr then
                        pcall(function() removeESP(player) end)
                        pcall(function() createESP(player) end)
                    end
                end
            end
        end)
        table.insert(espConnections, characterAddedConnection)
    end
    
    -- –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è ESP
    local function disableESP()
        if not espEnabled then 
            showOutput("üëÅÔ∏è ESP: —É–∂–µ –≤—ã–∫–ª—é—á–µ–Ω")
            return 
        end
        
        espEnabled = false
        showOutput("üëÅÔ∏è ESP: –≤—ã–∫–ª—é—á–µ–Ω")
        
        -- –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        for _, connection in ipairs(espConnections) do
            if connection then
                pcall(function() connection:Disconnect() end)
            end
        end
        espConnections = {}
        
        -- –£–¥–∞–ª—è–µ–º –≤—Å–µ ESP —ç–ª–µ–º–µ–Ω—Ç—ã
        for player, folder in pairs(espFolders) do
            if folder then
                pcall(function() folder:Destroy() end)
            end
        end
        espFolders = {}
    end
    
    -- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è ESP
    local function toggleESP()
        if espEnabled then
            disableESP()
        else
            enableESP()
        end
    end
    
    -- –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
    local function getPlayerList()
        local players = Players:GetPlayers()
        local playerList = "üë• –ò–≥—Ä–æ–∫–∏ –æ–Ω–ª–∞–π–Ω (" .. #players .. "):\n"
        
        for _, player in ipairs(players) do
            if player == plr then
                playerList = playerList .. "‚Ä¢ " .. player.Name .. " (–í—ã)\n"
            else
                playerList = playerList .. "‚Ä¢ " .. player.Name .. "\n"
            end
        end
        
        return playerList
    end
    
    return {
        enable = enableESP,
        disable = disableESP,
        toggle = toggleESP,
        getPlayerList = getPlayerList,
        isEnabled = function() return espEnabled end
    }
end

-- ==============================
-- === Wiki System (–≤–∞—à —Å—Ç–∏–ª—å) ===
-- ==============================
local function createWikiSystem()
    local Players = game:GetService("Players")
    local TweenService = game:GetService("TweenService")
    local RunService = game:GetService("RunService")
    local TextService = game:GetService("TextService")
    local plr = Players.LocalPlayer

    -- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π GUI –µ—Å–ª–∏ –µ—Å—Ç—å
    if plr.PlayerGui:FindFirstChild("WikiGUI") then
        plr.PlayerGui.WikiGUI:Destroy()
    end

    local WikiGUI = Instance.new("ScreenGui")
    WikiGUI.Name = "WikiGUI"
    WikiGUI.Parent = plr.PlayerGui
    WikiGUI.ResetOnSpawn = false

    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 800, 0, 600)
    MainFrame.Position = UDim2.new(0.5, -400, 0.5, -300)
    MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.15
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = WikiGUI
    MainFrame.Visible = false

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = MainFrame
    UICorner.CornerRadius = UDim.new(0, 12)

    -- –¢–µ–Ω—å/–æ–±–≤–æ–¥–∫–∞
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Parent = MainFrame
    UIStroke.Color = Color3.new(1, 1, 1)
    UIStroke.Thickness = 2
    UIStroke.Transparency = 0.7

    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, 0, 0, 60)
    TitleLabel.Position = UDim2.new(0, 0, 0, 0)
    TitleLabel.BackgroundColor3 = Color3.new(0, 0, 0)
    TitleLabel.BackgroundTransparency = 0.3
    TitleLabel.Text = "üìö WIKI - –ò–ì–†–û–í–ê–Ø –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô"
    TitleLabel.TextColor3 = Color3.new(1, 1, 1)
    TitleLabel.TextSize = 20
    TitleLabel.ZIndex = 12
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.BorderSizePixel = 0
    TitleLabel.Parent = MainFrame

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.Parent = TitleLabel
    TitleCorner.CornerRadius = UDim.new(0, 12)

    -- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Size = UDim2.new(1, -20, 1, -80)
    ContentContainer.Position = UDim2.new(0, 10, 0, 70)
    ContentContainer.BackgroundTransparency = 1
    ContentContainer.BorderSizePixel = 0
    ContentContainer.Parent = MainFrame

    -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–¥–µ–ª–æ–≤ (—Å–ª–µ–≤–∞)
    local ButtonsContainer = Instance.new("Frame")
    ButtonsContainer.Size = UDim2.new(0, 180, 1, 0)
    ButtonsContainer.Position = UDim2.new(0, 0, 0, 0)
    ButtonsContainer.BackgroundColor3 = Color3.new(0, 0, 0)
    ButtonsContainer.BackgroundTransparency = 0.2
    ButtonsContainer.BorderSizePixel = 0
    ButtonsContainer.Parent = ContentContainer

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–Ω–æ–ø–æ–∫
    local buttonsCorner = Instance.new("UICorner")
    buttonsCorner.Parent = ButtonsContainer
    buttonsCorner.CornerRadius = UDim.new(0, 8)

    -- –û–±–≤–æ–¥–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–Ω–æ–ø–æ–∫
    local buttonsStroke = Instance.new("UIStroke")
    buttonsStroke.Parent = ButtonsContainer
    buttonsStroke.Color = Color3.new(1, 1, 1)
    buttonsStroke.Thickness = 1
    buttonsStroke.Transparency = 0.5

    -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–ø—Ä–∞–≤–∞)
    local InfoContainer = Instance.new("Frame")
    InfoContainer.Size = UDim2.new(1, -200, 1, 0)
    InfoContainer.Position = UDim2.new(0, 190, 0, 0)
    InfoContainer.BackgroundColor3 = Color3.new(0, 0, 0)
    InfoContainer.BackgroundTransparency = 0.2
    InfoContainer.BorderSizePixel = 0
    InfoContainer.ClipsDescendants = true
    InfoContainer.Parent = ContentContainer

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    local infoCorner = Instance.new("UICorner")
    infoCorner.Parent = InfoContainer
    infoCorner.CornerRadius = UDim.new(0, 8)

    -- –û–±–≤–æ–¥–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    local infoStroke = Instance.new("UIStroke")
    infoStroke.Parent = InfoContainer
    infoStroke.Color = Color3.new(1, 1, 1)
    infoStroke.Thickness = 1
    infoStroke.Transparency = 0.5

    -- UIListLayout –¥–ª—è –∫–Ω–æ–ø–æ–∫
    local ButtonsLayout = Instance.new("UIListLayout")
    ButtonsLayout.Padding = UDim.new(0, 8)
    ButtonsLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ButtonsLayout.Parent = ButtonsContainer

    -- Padding –¥–ª—è –∫–Ω–æ–ø–æ–∫
    local ButtonsPadding = Instance.new("UIPadding")
    ButtonsPadding.PaddingTop = UDim.new(0, 10)
    ButtonsPadding.PaddingLeft = UDim.new(0, 10)
    ButtonsPadding.PaddingRight = UDim.new(0, 10)
    ButtonsPadding.Parent = ButtonsContainer

    -- –°–æ—Å—Ç–æ—è–Ω–∏–µ
    local currentSection = nil
    local currentSubSection = nil

    -- –î–∞–Ω–Ω—ã–µ –≤–∏–∫–∏ (–æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ –∂–µ)
    local wikiData = {
        body = {
            name = "üí™ BODY",
            subsections = {
                locations = {
                    name = "üìç Body Locations",
                    content = [[
Secret Training Port (City Port)

Ice Bath - Need 100 BT 
(x5 | Afk Farm: 380BT | Min Amount: 5 BT)

Fire Bath - Need 10k BT 
(x10 | Afk Farm: 38K BT | Min Amount 500 BT)

Iceberg - Need 100k BT 
(x20 | Afk Farm: 380K BT | Min Amount 5K BT)

Tornado - Need 1M BT 
(x50 | Afk Farm: 3.8M BT | Min Amount: 50K BT)

Volcano - Need 10M BT 
(x100 | Afk Farm: 38M BT | Min Amount: 500K BT)

Body Toughness Training Areas (DST) - Need:

Hell Fire Pit - Required Amount 1B BT 
(x2k | Afk Farm: 3.8B BT | Min Amount: 50M BT)

Green Acid Pool - Required Amount 100B 
(x40k | Afk Farm: 360B BT | Min Amount: 5B BT)

Red Acid Pool - Required Amount 10T 
(x800k | Afk Farm: 38T BT | Min Amount: 500B BT)]]
                },
                farm = {
                    name = "‚ö° Body Farm Rates",
                    content = [[
Push-ups: 3,330.0 per hour

The Ice Bath: 14,257.8125 per hour

The Fire Bath: 28,515.625 per hour

The Iceberg: 57,031.25 per hour

The Tornado: 142,578.125 per hour

The Volcano: 285,156.25 per hour

The Hell Pit: 5,703,125.0 per hour

The Green Acid Pool: 114,062,500.0 per hour

The Red Acid Pool: 2,304,000,000.0 per hour]]
                }
            }
        },
        fist = {
            name = "üëä FIST",
            subsections = {
                locations = {
                    name = "üìç Fist Locations",
                    content = [[
The Rock - (x10) 

The Crystal - Requires the Ability to Fly: (x100)

Blue God Star - Requires 1B Fist Strength: (x2,000)

Green God Star - Requires 100B Fist Strength: (x40,000)

Red God Star - Requires 10T Fist Strength: (x800,000)]]
                },
                farm = {
                    name = "‚ö° Fist Farm Rates",
                    content = [[
Punching Air: 3,529.4 per hour

Punching The Rock: 35,294.1 per hour

Punching the Crystal: 352,941.2 per hour

Punching the Blue God Star: 7,058,823.5 per hour

Punching the Green God Star: 141,176,470.6 per hour

Punching the Red God Star: 2,823,529,411.8 per hour]]
                }
            }
        },
        psychic = {
            name = "üîÆ PSYCHIC",
            subsections = {
                locations = {
                    name = "üìç Psychic Locations",
                    content = [[
First Grass Lawn - Requires 1M PP (x100)

Second Grass lawn - Requires 1B PP (x10k)

The Bridge - Requires 1T PP (x1M)

The Waterfall - Requires 1Qa PP (x100M)]]
                },
                farm = {
                    name = "‚ö° Psychic Farm Rates",
                    content = [[
Basic Meditation: 2,400.0 per hour

Flying Meditation: 24,000.0 per hour

The First Grass Lawn: 240,000.0 per hour

The Second Grass Lawn: 24,000,000.0 per hour

The Zen Temple Bridge: 2,400,000,000.0 per hour

The Zen Temple Waterfall: 240,000,000,000.0 per hour]]
                }
            }
        },
        speed = {
            name = "üèÉ SPEED",
            subsections = {
                type = {
                    name = "‚öñÔ∏è Speed Weights",
                    content = [[
100 LB (x2) - 100 Movement Speed needed to use. (White Weights)

1 TON (x5) - 5K Movement Speed needed to use. (Yellow Weights)

10 TON (x10) - 500K Movement Speed needed to use. (Blue Weights)

100 TON (x20) - 10M Movement Speed needed to use. (Red Weights)]]
                }
            }
        },
        jump = {
            name = "ü¶ò JUMP",
            subsections = {
                type = {
                    name = "‚öñÔ∏è Jump Weights",
                    content = [[
100 LB (x2) - 5k Jump Force needed to use. (White Weights)

1 TON (x5) - 200k Jump Force needed to use. (Yellow weights)

10 TON (x10) - 2M Jump Force needed to use. (Blue weights)

100 TON (x20) - 10M Jump Force needed to use. (Red weights)]]
                }
            }
        },
        quests = {
            name = "üìã QUESTS",
            subsections = {
                quests = {
                    name = "üéØ –í—Å–µ –ö–≤–µ—Å—Ç—ã",
                    content = [[
Mainly Quest    Requirements    Reward

1 Train Fist Strength - Required: 20     10 Tokens / 20 Tokens(VIP)
Train Body Toughness - Required: 20     10 Tokens / 20 Tokens(VIP)

2 Train Movement Speed - Required: 20    10 Tokens / 20 Tokens(VIP)
Train Jump Force - Required: 20         10 Tokens / 20 Tokens(VIP)

3 Train Psychic Power - Required: 100    50 Tokens / 100 Tokens(VIP)
Unlocks Invisibility Skill

4 Train Fist Strength - Required: 1,000  100 Tokens / 200 Tokens(VIP)
Unlocks Energy Sphere Punch Skill

5 Train Body Toughness - Required: 1,000 100 Tokens / 200 Tokens(VIP)
Unlocks Damage Reflection

6 Train Movement Speed - Required: 1000  100 Tokens / 200 Tokens(VIP)
Train Psychic Power - Required: 1,000    100 Tokens / 200 Tokens(VIP)
Unlocks Weights as the quest is received
Unlock Water Run

7 Train Jump Force - Required: 1,000     100 Tokens

8 Train Movement Speed - Required: 10K   250 Tokens / 500 Tokens(VIP)
Unlock Teleport Skill

9 Train Psychic Power - Required: 10K    250 Tokens / 500 Tokens(VIP)
Train Jump Force- Required: 10K          250 Tokens / 500 Tokens(VIP)
Unlock Fly Skill

10 Train Fist Strength - Required: 100K  500 Tokens / 1000 Tokens(VIP)
Unlock Bullet Punch

11 Train Psychic Power - Required: 100K  500 tokens / 1000 Tokens(VIP)
Unlock Soul Attack

12 Train Fist Strength - Required: 1M    1000 tokens / 2000 Tokens(VIP)
Train Body Toughness - Required: 1M      1000 tokens / 2000 Tokens(VIP)
Train Psychic Power - Required: 1M       1000 tokens / 2000 Tokens(VIP)
Unlock Conceal/Reveal Aura

13 Train Psychic Power - Required: 100M  2500 tokens / 5000 Tokens(VIP)
Villains/Heroes killed - Required: 1000  2500 tokens / 5000 Tokens(VIP)
Unlock Killing Intent]]
                }
            }
        }
    }

    -- –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ —Ä–∞–∑–¥–µ–ª–∞ –≤ –≤–∞—à–µ–º —Å—Ç–∏–ª–µ
    local function createSectionButton(sectionKey)
        local button = Instance.new("TextButton")
        button.Name = sectionKey
        button.Size = UDim2.new(1, 0, 0, 50)
        button.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        button.BackgroundTransparency = 0.2
        button.Text = wikiData[sectionKey].name
        button.TextColor3 = Color3.new(1, 1, 1)
        button.TextSize = 16
        button.Font = Enum.Font.GothamBold
        button.BorderSizePixel = 0
        button.LayoutOrder = table.find({"body", "fist", "psychic", "speed", "jump", "quests"}, sectionKey) or 0
        button.Parent = ButtonsContainer

        -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.Parent = button
        buttonCorner.CornerRadius = UDim.new(0, 8)

        -- –û–±–≤–æ–¥–∫–∞ –∫–Ω–æ–ø–∫–∏
        local buttonStroke = Instance.new("UIStroke")
        buttonStroke.Parent = button
        buttonStroke.Color = Color3.new(1, 1, 1)
        buttonStroke.Thickness = 1.5
        buttonStroke.Transparency = 0.5

        return button
    end

    -- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∞ –≤ –≤–∞—à–µ–º —Å—Ç–∏–ª–µ
    local function createSubSectionContent(sectionKey, subKey, subData)
        -- –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
        for _, child in ipairs(InfoContainer:GetChildren()) do
            child:Destroy()
        end

        -- Padding –¥–ª—è InfoContainer
        local infoPadding = Instance.new("UIPadding")
        infoPadding.PaddingTop = UDim.new(0, 10)
        infoPadding.PaddingLeft = UDim.new(0, 15)
        infoPadding.PaddingRight = UDim.new(0, 15)
        infoPadding.PaddingBottom = UDim.new(0, 10)
        infoPadding.Parent = InfoContainer

        -- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∞
        local title = Instance.new("TextLabel")
        title.Size = UDim2.new(1, 0, 0, 40)
        title.Position = UDim2.new(0, 0, 0, 0)
        title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        title.BackgroundTransparency = 0.3
        title.Text = "  " .. subData.name
        title.TextColor3 = Color3.new(1, 1, 1)
        title.TextSize = 18
        title.ZIndex = 12
        title.Font = Enum.Font.GothamBold
        title.TextXAlignment = Enum.TextXAlignment.Left
        title.BorderSizePixel = 0
        title.Parent = InfoContainer

        -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        local titleCorner = Instance.new("UICorner")
        titleCorner.Parent = title
        titleCorner.CornerRadius = UDim.new(0, 8)

        -- –û–±–≤–æ–¥–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        local titleStroke = Instance.new("UIStroke")
        titleStroke.Parent = title
        titleStroke.Color = Color3.new(1, 1, 1)
        titleStroke.Thickness = 1
        titleStroke.Transparency = 0.5

        -- ScrollingFrame –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        local scrollFrame = Instance.new("ScrollingFrame")
        scrollFrame.Size = UDim2.new(1, 0, 1, -50)
        scrollFrame.Position = UDim2.new(0, 0, 0, 45)
        scrollFrame.BackgroundTransparency = 1
        scrollFrame.BorderSizePixel = 0
        scrollFrame.ScrollBarThickness = 8
        scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(200, 200, 200)
        scrollFrame.ScrollBarImageTransparency = 0.5
        scrollFrame.VerticalScrollBarInset = Enum.ScrollBarInset.Always
        scrollFrame.ZIndex = 12
        scrollFrame.Parent = InfoContainer

        -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ–∫—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ ScrollingFrame
        local textContainer = Instance.new("Frame")
        textContainer.Size = UDim2.new(1, 0, 0, 0)
        textContainer.BackgroundTransparency = 1
        textContainer.BorderSizePixel = 0
        textContainer.ZIndex = 12
        textContainer.Parent = scrollFrame

        -- –¢–µ–∫—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        local contentText = Instance.new("TextLabel")
        contentText.Size = UDim2.new(1, 0, 0, 50)
        contentText.Position = UDim2.new(0, 0, 0, 0)
        contentText.BackgroundTransparency = 1
        contentText.Text = subData.content
        contentText.TextColor3 = Color3.new(1,1,1)
        contentText.TextSize = 14
        contentText.TextXAlignment = Enum.TextXAlignment.Left
        contentText.TextYAlignment = Enum.TextYAlignment.Top
        contentText.TextWrapped = true
        contentText.Font = Enum.Font.Gotham
        contentText.ZIndex = 12
        contentText.Parent = textContainer

        task.wait(0.05)

        -- –ñ–¥–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
        RunService.RenderStepped:Wait()

        -- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞
        local textSize = TextService:GetTextSize(
            subData.content,
            contentText.TextSize,
            contentText.Font,
            Vector2.new(scrollFrame.AbsoluteSize.X - 10, math.huge)
        )

        -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        contentText.Size = UDim2.new(1, 0, 0, textSize.Y)
        textContainer.Size = UDim2.new(1, 0, 0, textSize.Y)
        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, textSize.Y)

        -- –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        InfoContainer.Size = UDim2.new(0, 0, 1, 0)
        InfoContainer.Visible = true
        
        local tween = TweenService:Create(InfoContainer, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Size = UDim2.new(1, -200, 1, 0)
        })
        tween:Play()

        return InfoContainer
    end

    -- –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
    local sectionsOrder = {"body", "fist", "psychic", "speed", "jump", "quests"}
    local sectionButtons = {}

    for i, sectionKey in ipairs(sectionsOrder) do
        local button = createSectionButton(sectionKey)
        sectionButtons[sectionKey] = button
        
        button.MouseButton1Click:Connect(function()
            -- Reset all section buttons
            for _, btn in pairs(sectionButtons) do
                btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                btn.BackgroundTransparency = 0.2
            end
            
            -- Highlight active button
            button.BackgroundColor3 = Color3.fromRGB(50, 100, 200)
            button.BackgroundTransparency = 0.1
            
            -- Show first subsection of selected section
            local sectionData = wikiData[sectionKey]
            local firstSubKey = next(sectionData.subsections)
            
            if firstSubKey then
                currentSection = sectionKey
                currentSubSection = firstSubKey
                createSubSectionContent(sectionKey, firstSubKey, sectionData.subsections[firstSubKey])
                
                -- Optional: Reset and create subsection navigation
                createSubSectionNavigation(sectionData.subsections)
            end
        end)
    end
    -- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ Wiki
    local function toggleWiki()
        if MainFrame.Visible then
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Position = UDim2.new(0.5, -400, 0.5, -300),
                Size = UDim2.new(0, 0, 0, 0)
            })
            tween:Play()
            tween.Completed:Wait()
            MainFrame.Visible = false
        else
            -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            for _, btn in pairs(sectionButtons) do
                btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                btn.BackgroundTransparency = 0.2
            end
            currentSection = nil
            currentSubSection = nil
            
            MainFrame.Visible = true
            MainFrame.Size = UDim2.new(0, 0, 0, 0)
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 800, 0, 600),
                Position = UDim2.new(0.5, -400, 0.5, -300)
            })
            tween:Play()
        end
    end

    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ —Ñ—Ä–µ–π–º–∞
    local function setupClickOutside()
        local background = Instance.new("TextButton")
        background.Parent = WikiGUI
        background.Size = UDim2.new(1, 0, 1, 0)
        background.Position = UDim2.new(0, 0, 0, 0)
        background.BackgroundTransparency = 1
        background.Text = ""
        background.Visible = false
        background.ZIndex = 0 -- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ–Ω –∏–º–µ–µ—Ç –Ω–∏–∑–∫–∏–π ZIndex
        
        -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ–∫–∏–π ZIndex –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ MainFrame
        MainFrame.ZIndex = 10
        ButtonsContainer.ZIndex = 11
        InfoContainer.ZIndex = 11
        
        for _, btn in pairs(sectionButtons) do
            btn.ZIndex = 12
        end
        
        background.MouseButton1Click:Connect(function()
            if MainFrame.Visible then
                toggleWiki()
            end
        end)
        
        MainFrame:GetPropertyChangedSignal("Visible"):Connect(function()
            background.Visible = MainFrame.Visible
        end)
    end

    setupClickOutside()

    return {
        toggle = toggleWiki,
        gui = WikiGUI
    }
end

-- ==============================
-- === Progress GUI (–≤–∞—à —Å—Ç–∏–ª—å) ===
-- ==============================
local function createProgressGUI()
    if plr.PlayerGui:FindFirstChild("ProgressGUI") then
        plr.PlayerGui.ProgressGUI:Destroy()
    end

    local ProgressGUI = Instance.new("ScreenGui")
    ProgressGUI.Name = "ProgressGUI"
    ProgressGUI.Parent = plr.PlayerGui
    ProgressGUI.ResetOnSpawn = false

    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 400, 0, 500)
    MainFrame.Position = UDim2.new(0.5, -200, 0.5, -250)
    MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.15
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ProgressGUI
    MainFrame.Visible = false

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞
    local UICorner = Instance.new("UICorner")
    UICorner.Parent = MainFrame
    UICorner.CornerRadius = UDim.new(0, 12)

    -- –¢–µ–Ω—å/–æ–±–≤–æ–¥–∫–∞
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Parent = MainFrame
    UIStroke.Color = Color3.new(1, 1, 1)
    UIStroke.Thickness = 2
    UIStroke.Transparency = 0.7

    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, 0, 0, 60)
    TitleLabel.Position = UDim2.new(0, 0, 0, 0)
    TitleLabel.BackgroundColor3 = Color3.new(0, 0, 0)
    TitleLabel.BackgroundTransparency = 0.3
    TitleLabel.Text = "–û–¢–°–õ–ï–ñ–ò–í–ê–ù–ò–ï –ü–†–û–ì–†–ï–°–°–ê"
    TitleLabel.TextColor3 = Color3.new(1, 1, 1)
    TitleLabel.TextSize = 20
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.BorderSizePixel = 0
    TitleLabel.Parent = MainFrame

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.Parent = TitleLabel
    TitleCorner.CornerRadius = UDim.new(0, 12)

    -- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏
    local TimeInfo = Instance.new("TextLabel")
    TimeInfo.Size = UDim2.new(1, -20, 0, 40)
    TimeInfo.Position = UDim2.new(0, 10, 0, 65)
    TimeInfo.BackgroundTransparency = 1
    TimeInfo.Text = "–í—Ä–µ–º—è: 00:00"
    TimeInfo.TextColor3 = Color3.new(1, 1, 1)
    TimeInfo.TextSize = 16
    TimeInfo.TextXAlignment = Enum.TextXAlignment.Left
    TimeInfo.Font = Enum.Font.Gotham
    TimeInfo.Parent = MainFrame

    -- –°—Ç–∞—Ç—É—Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Size = UDim2.new(1, -20, 0, 30)
    StatusLabel.Position = UDim2.new(0, 10, 0, 105)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "–°—Ç–∞—Ç—É—Å: –ù–µ –∞–∫—Ç–∏–≤–Ω–æ"
    StatusLabel.TextColor3 = Color3.new(1, 0.5, 0.5)
    StatusLabel.TextSize = 14
    StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
    StatusLabel.Font = Enum.Font.Gotham
    StatusLabel.Parent = MainFrame

    -- –õ–∏–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    local Divider = Instance.new("Frame")
    Divider.Size = UDim2.new(1, -20, 0, 1)
    Divider.Position = UDim2.new(0, 10, 0, 140)
    Divider.BackgroundColor3 = Color3.new(1, 1, 1)
    Divider.BackgroundTransparency = 0.7
    Divider.BorderSizePixel = 0
    Divider.Parent = MainFrame

    -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    local StatsContainer = Instance.new("Frame")
    StatsContainer.Size = UDim2.new(1, -20, 0, 280)
    StatsContainer.Position = UDim2.new(0, 10, 0, 150)
    StatsContainer.BackgroundTransparency = 1
    StatsContainer.BorderSizePixel = 0
    StatsContainer.Parent = MainFrame

    -- –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
    local function createStatRow(parent, statName, startValue, endValue, position)
        local rowFrame = Instance.new("Frame")
        rowFrame.Parent = parent
        rowFrame.Size = UDim2.new(1, 0, 0, 50)
        rowFrame.Position = position
        rowFrame.BackgroundTransparency = 1
        rowFrame.BorderSizePixel = 0

        -- –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = rowFrame
        nameLabel.Size = UDim2.new(1, 0, 0, 20)
        nameLabel.Position = UDim2.new(0, 0, 0, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = statName
        nameLabel.TextColor3 = Color3.new(1, 1, 1)
        nameLabel.TextSize = 16
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.Font = Enum.Font.GothamBold

        -- –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        local startLabel = Instance.new("TextLabel")
        startLabel.Parent = rowFrame
        startLabel.Size = UDim2.new(0.45, 0, 0, 15)
        startLabel.Position = UDim2.new(0, 0, 0, 25)
        startLabel.BackgroundTransparency = 1
        startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. (startValue or "N/A")
        startLabel.TextColor3 = Color3.new(0.7, 0.7, 0.7)
        startLabel.TextSize = 12
        startLabel.TextXAlignment = Enum.TextXAlignment.Left
        startLabel.Font = Enum.Font.Gotham
        startLabel.Name = "StartValue"

        -- –ö–æ–Ω–µ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        local endLabel = Instance.new("TextLabel")
        endLabel.Parent = rowFrame
        endLabel.Size = UDim2.new(0.45, 0, 0, 15)
        endLabel.Position = UDim2.new(0.55, 0, 0, 25)
        endLabel.BackgroundTransparency = 1
        endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. (endValue or "N/A")
        endLabel.TextColor3 = Color3.new(0.7, 0.7, 0.7)
        endLabel.TextSize = 12
        endLabel.TextXAlignment = Enum.TextXAlignment.Left
        endLabel.Font = Enum.Font.Gotham
        endLabel.Name = "EndValue"

        -- –†–∞–∑–Ω–∏—Ü–∞
        local diffLabel = Instance.new("TextLabel")
        diffLabel.Parent = rowFrame
        diffLabel.Size = UDim2.new(1, 0, 0, 15)
        diffLabel.Position = UDim2.new(0, 0, 0, 40)
        diffLabel.BackgroundTransparency = 1
        diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: -"
        diffLabel.TextColor3 = Color3.new(1, 1, 1)
        diffLabel.TextSize = 13
        diffLabel.TextXAlignment = Enum.TextXAlignment.Left
        diffLabel.Font = Enum.Font.GothamBold
        diffLabel.Name = "DiffValue"

        return {
            startLabel = startLabel, 
            endLabel = endLabel, 
            diffLabel = diffLabel
        }
    end

    -- –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    local statRows = {
        fs = createStatRow(StatsContainer, "Fist Strength", nil, nil, UDim2.new(0, 0, 0, 0)),
        pp = createStatRow(StatsContainer, "Psychic Power", nil, nil, UDim2.new(0, 0, 0, 55)),
        jf = createStatRow(StatsContainer, "Jump Force", nil, nil, UDim2.new(0, 0, 0, 110)),
        ms = createStatRow(StatsContainer, "Movement Speed", nil, nil, UDim2.new(0, 0, 0, 165)),
        bt = createStatRow(StatsContainer, "Body Toughness", nil, nil, UDim2.new(0, 0, 0, 220))
    }

    -- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Parent = MainFrame
    buttonFrame.Size = UDim2.new(1, -20, 0, 40)
    buttonFrame.Position = UDim2.new(0, 10, 1, -50)
    buttonFrame.BackgroundTransparency = 1
    buttonFrame.BorderSizePixel = 0

    -- –ö–Ω–æ–ø–∫–∞ Start
    local StartButton = Instance.new("TextButton")
    StartButton.Parent = buttonFrame
    StartButton.Size = UDim2.new(0.3, -5, 1, 0)
    StartButton.Position = UDim2.new(0, 0, 0, 0)
    StartButton.BackgroundColor3 = Color3.new(0.2, 0.7, 0.2)
    StartButton.BackgroundTransparency = 0.2
    StartButton.Text = "START"
    StartButton.TextColor3 = Color3.new(1, 1, 1)
    StartButton.TextSize = 14
    StartButton.Font = Enum.Font.GothamBold
    StartButton.BorderSizePixel = 0

    -- –ö–Ω–æ–ø–∫–∞ Stop
    local StopButton = Instance.new("TextButton")
    StopButton.Parent = buttonFrame
    StopButton.Size = UDim2.new(0.3, -5, 1, 0)
    StopButton.Position = UDim2.new(0.35, 0, 0, 0)
    StopButton.BackgroundColor3 = Color3.new(0.8, 0.5, 0.1)
    StopButton.BackgroundTransparency = 0.2
    StopButton.Text = "STOP"
    StopButton.TextColor3 = Color3.new(1, 1, 1)
    StopButton.TextSize = 14
    StopButton.Font = Enum.Font.GothamBold
    StopButton.BorderSizePixel = 0

    -- –ö–Ω–æ–ø–∫–∞ Close
    local CloseButton = Instance.new("TextButton")
    CloseButton.Parent = buttonFrame
    CloseButton.Size = UDim2.new(0.3, -5, 1, 0)
    CloseButton.Position = UDim2.new(0.7, 0, 0, 0)
    CloseButton.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
    CloseButton.BackgroundTransparency = 0.2
    CloseButton.Text = "CLOSE"
    CloseButton.TextColor3 = Color3.new(1, 1, 1)
    CloseButton.TextSize = 14
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.BorderSizePixel = 0

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.Parent = StartButton
    buttonCorner.CornerRadius = UDim.new(0, 8)
    
    local buttonCorner2 = Instance.new("UICorner")
    buttonCorner2.Parent = StopButton
    buttonCorner2.CornerRadius = UDim.new(0, 8)
    
    local buttonCorner3 = Instance.new("UICorner")
    buttonCorner3.Parent = CloseButton
    buttonCorner3.CornerRadius = UDim.new(0, 8)

    -- –û–±–≤–æ–¥–∫–∞ –∫–Ω–æ–ø–æ–∫
    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Parent = StartButton
    buttonStroke.Color = Color3.new(1, 1, 1)
    buttonStroke.Thickness = 1.5
    buttonStroke.Transparency = 0.5
    
    local buttonStroke2 = Instance.new("UIStroke")
    buttonStroke2.Parent = StopButton
    buttonStroke2.Color = Color3.new(1, 1, 1)
    buttonStroke2.Thickness = 1.5
    buttonStroke2.Transparency = 0.5
    
    local buttonStroke3 = Instance.new("UIStroke")
    buttonStroke3.Parent = CloseButton
    buttonStroke3.Color = Color3.new(1, 1, 1)
    buttonStroke3.Thickness = 1.5
    buttonStroke3.Transparency = 0.5

    -- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
    local trackingActive = false
    local startStats = {}
    local endStats = {}
    local startTime = 0
    local elapsedTime = 0
    local timeConnection = nil

    -- –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
    local function formatTime(seconds)
        local hours = math.floor(seconds / 3600)
        local minutes = math.floor((seconds % 3600) / 60)
        local secs = math.floor(seconds % 60)
        
        if hours > 0 then
            return string.format("%02d:%02d:%02d", hours, minutes, secs)
        else
            return string.format("%02d:%02d", minutes, secs)
        end
    end

    -- –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
    local function updateTime()
        if trackingActive then
            elapsedTime = os.time() - startTime
            TimeInfo.Text = "–í—Ä–µ–º—è: " .. formatTime(elapsedTime)
        end
    end

    -- –§—É–Ω–∫—Ü–∏—è —Å—Ç–∞—Ä—Ç–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
    local function startTracking()
        startStats = getAllStatsText()
        startTime = os.time()
        trackingActive = true
        elapsedTime = 0
        
        StatusLabel.Text = "–°—Ç–∞—Ç—É—Å: –ê–∫—Ç–∏–≤–Ω–æ"
        StatusLabel.TextColor3 = Color3.new(0.5, 1, 0.5)
        TimeInfo.Text = "–í—Ä–µ–º—è: 00:00"
        
        -- –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        statRows.fs.startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. startStats.FistStrength
        statRows.pp.startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. startStats.PsychicPower
        statRows.jf.startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. startStats.JumpForce
        statRows.ms.startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. startStats.MovementSpeed
        statRows.bt.startLabel.Text = "–ù–∞—á–∞–ª–æ: " .. startStats.BodyToughness
        
        -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ä–∞–∑–Ω–∏—Ü—É
        for _, row in pairs(statRows) do
            row.endLabel.Text = "–ö–æ–Ω–µ—Ü: N/A"
            row.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: -"
            row.diffLabel.TextColor3 = Color3.new(1, 1, 1)
        end
        
        -- –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        if timeConnection then
            timeConnection:Disconnect()
        end
        timeConnection = RunService.Heartbeat:Connect(updateTime)
    end

    -- –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
    local function stopTracking()
        if not trackingActive then return end
        
        endStats = getAllStatsText()
        trackingActive = false
        
        StatusLabel.Text = "–°—Ç–∞—Ç—É—Å: –ó–∞–≤–µ—Ä—à–µ–Ω–æ"
        StatusLabel.TextColor3 = Color3.new(1, 1, 0.5)
        
        -- –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        statRows.fs.endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. endStats.FistStrength
        statRows.pp.endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. endStats.PsychicPower
        statRows.jf.endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. endStats.JumpForce
        statRows.ms.endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. endStats.MovementSpeed
        statRows.bt.endLabel.Text = "–ö–æ–Ω–µ—Ü: " .. endStats.BodyToughness
                
        -- –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É —Å —Ü–≤–µ—Ç–∞–º–∏
        local fsDiff, fsColor = formatDifference(startStats.FistStrength, endStats.FistStrength)
        local ppDiff, ppColor = formatDifference(startStats.PsychicPower, endStats.PsychicPower)
        local jfDiff, jfColor = formatDifference(startStats.JumpForce, endStats.JumpForce)
        local msDiff, msColor = formatDifference(startStats.MovementSpeed, endStats.MovementSpeed)
        local btDiff, btColor = formatDifference(startStats.BodyToughness, endStats.BodyToughness)
        
        statRows.fs.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: " .. fsDiff
        statRows.fs.diffLabel.TextColor3 = fsColor

        statRows.pp.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: " .. ppDiff
        statRows.pp.diffLabel.TextColor3 = ppColor

        statRows.jf.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: " .. jfDiff
        statRows.jf.diffLabel.TextColor3 = jfColor

        statRows.ms.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: " .. msDiff
        statRows.ms.diffLabel.TextColor3 = msColor

        statRows.bt.diffLabel.Text = "–†–∞–∑–Ω–∏—Ü–∞: " .. btDiff
        statRows.bt.diffLabel.TextColor3 = btColor
        
        -- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        if timeConnection then
            timeConnection:Disconnect()
            timeConnection = nil
        end
    end

    -- –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏
    local function toggleProgressPanel()
        if MainFrame.Visible then
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Position = UDim2.new(0.5, -200, 0.5, -250),
                Size = UDim2.new(0, 0, 0, 0)
            })
            tween:Play()
            tween.Completed:Wait()
            MainFrame.Visible = false
        else
            MainFrame.Visible = true
            MainFrame.Size = UDim2.new(0, 0, 0, 0)
            local tween = TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 400, 0, 500),
                Position = UDim2.new(0.5, -200, 0.5, -250)
            })
            tween:Play()
        end
    end

    -- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
    StartButton.MouseButton1Click:Connect(startTracking)
    StopButton.MouseButton1Click:Connect(stopTracking)
    CloseButton.MouseButton1Click:Connect(toggleProgressPanel)

    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ —Ñ—Ä–µ–π–º–∞
    local function setupClickOutside()
        local background = Instance.new("TextButton")
        background.Parent = ProgressGUI
        background.Size = UDim2.new(1, 0, 1, 0)
        background.Position = UDim2.new(0, 0, 0, 0)
        background.BackgroundTransparency = 1
        background.Text = ""
        background.Visible = false
        
        background.MouseButton1Click:Connect(function()
            if MainFrame.Visible then
                toggleProgressPanel()
            end
        end)
        
        MainFrame:GetPropertyChangedSignal("Visible"):Connect(function()
            background.Visible = MainFrame.Visible
        end)
    end

    setupClickOutside()

    return {
        toggle = toggleProgressPanel,
        startTracking = startTracking,
        stopTracking = stopTracking,
        isTracking = function() return trackingActive end,
        gui = ProgressGUI
    }
end

-- ==============================
-- ===     Command Console    ===
-- ==============================
local function createCommandConsole()
    local Players = game:GetService("Players")
    local UIS = game:GetService("UserInputService")
    local TweenService = game:GetService("TweenService")
    local plr = Players.LocalPlayer

    if plr.PlayerGui:FindFirstChild("CommandConsole") then
        plr.PlayerGui.CommandConsole:Destroy()
    end

    local consoleGui = Instance.new("ScreenGui")
    consoleGui.Name = "CommandConsole"
    consoleGui.Parent = plr.PlayerGui
    consoleGui.ResetOnSpawn = false

    -- –°–æ–∑–¥–∞–µ–º TextBox (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç)
    local TextBox = Instance.new("TextBox")
    TextBox.Parent = consoleGui
    TextBox.Size = UDim2.new(0, 200, 0, 43)
    TextBox.Position = UDim2.new(0.5, -100, 1, -109) -- –¶–µ–Ω—Ç—Ä –Ω–∏–∑, –ø–æ–¥–Ω—è—Ç –Ω–∞ 109
    TextBox.PlaceholderText = "–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É..."
    TextBox.BackgroundColor3 = Color3.new(0, 0, 0)
    TextBox.BackgroundTransparency = 0.2
    TextBox.TextColor3 = Color3.new(1, 1, 1)
    TextBox.TextSize = 14
    TextBox.TextXAlignment = Enum.TextXAlignment.Left
    TextBox.TextYAlignment = Enum.TextYAlignment.Center
    TextBox.Visible = false

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è TextBox
    local UICorner1 = Instance.new("UICorner")
    UICorner1.Parent = TextBox
    UICorner1.CornerRadius = UDim.new(0, 12)

    -- –°–æ–∑–¥–∞–µ–º TextButton (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç)
    local TextButton = Instance.new("TextButton")
    TextButton.Parent = consoleGui
    TextButton.Size = UDim2.new(0, 80, 0, 43)
    TextButton.Position = UDim2.new(0.5, 20, 1, -109) -- –°–ø—Ä–∞–≤–∞ –æ—Ç TextBox
    TextButton.Text = "OK"
    TextButton.BackgroundColor3 = Color3.new(0, 0, 0)
    TextButton.BackgroundTransparency = 0.2
    TextButton.TextColor3 = Color3.new(1, 1, 1)
    TextButton.TextSize = 16
    TextButton.TextXAlignment = Enum.TextXAlignment.Center
    TextButton.TextYAlignment = Enum.TextYAlignment.Center
    TextButton.Visible = false

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–ª—è TextButton
    local UICorner2 = Instance.new("UICorner")
    UICorner2.Parent = TextButton
    UICorner2.CornerRadius = UDim.new(0, 12)

    -- Output Frame (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä) - –ü–ï–†–ï–ú–ï–©–ï–ù –í–ù–ò–ó –°–õ–ï–í–ê –û–¢ –ö–û–ù–°–û–õ–ò
    local outputFrame = Instance.new("Frame")
    outputFrame.Size = UDim2.new(0, 350, 0, 0) -- –ù–∞—á–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ 0
    outputFrame.Position = UDim2.new(0, 20, 1, -200) -- –°–ª–µ–≤–∞ –≤–Ω–∏–∑—É, –≤—ã—à–µ –∫–æ–Ω—Å–æ–ª–∏
    outputFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    outputFrame.BackgroundTransparency = 0.15
    outputFrame.BorderSizePixel = 0
    outputFrame.Visible = false
    outputFrame.Parent = consoleGui
    outputFrame.ClipsDescendants = true

    -- –ó–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ output frame
    local outputCorner = Instance.new("UICorner")
    outputCorner.Parent = outputFrame
    outputCorner.CornerRadius = UDim.new(0, 12)

    -- –û–±–≤–æ–¥–∫–∞ output frame
    local outputStroke = Instance.new("UIStroke")
    outputStroke.Parent = outputFrame
    outputStroke.Color = Color3.new(1, 1, 1)
    outputStroke.Thickness = 2
    outputStroke.Transparency = 0.7

    local outputLabel = Instance.new("TextLabel")
    outputLabel.Size = UDim2.new(1, -20, 0, 0) -- –ê–≤—Ç–æ-–≤—ã—Å–æ—Ç–∞
    outputLabel.Position = UDim2.new(0, 10, 0, 10)
    outputLabel.BackgroundTransparency = 1
    outputLabel.TextColor3 = Color3.new(1, 1, 1)
    outputLabel.TextSize = 14
    outputLabel.TextXAlignment = Enum.TextXAlignment.Left
    outputLabel.TextYAlignment = Enum.TextYAlignment.Top
    outputLabel.TextWrapped = true
    outputLabel.Font = Enum.Font.Gotham
    outputLabel.Text = ""
    outputLabel.Parent = outputFrame
    outputLabel.AutomaticSize = Enum.AutomaticSize.Y 

    -- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
    local isExpanded = false

    -- –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥
    local history = {}
    local historyIndex = 0

    -- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –≤—ã–≤–æ–¥–∞ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –∏ –∞–Ω–∏–º–∞—Ü–∏–µ–π
    local function showOutput(text)
        outputLabel.Text = tostring(text or "")
        
        -- –ñ–¥–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
        task.wait(0.05)
        
        -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É —Ñ—Ä–µ–π–º–∞ –ø–æ –≤—ã—Å–æ—Ç–µ —Ç–µ–∫—Å—Ç–∞ + –æ—Ç—Å—Ç—É–ø—ã
        local textHeight = outputLabel.TextBounds.Y
        local frameHeight = math.min(textHeight + 20, 600) -- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ 300
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è output frame
        outputFrame.Size = UDim2.new(0, 350, 0, 0)
        outputFrame.Position = UDim2.new(0, 20, 1, -200)
        outputFrame.Visible = true
        
        local tween = TweenService:Create(outputFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 350, 0, frameHeight),
            Position = UDim2.new(0, 20, 1, -200 - frameHeight) -- –ü–æ–¥–Ω–∏–º–∞–µ–º –≤–≤–µ—Ä—Ö –Ω–∞ –≤—ã—Å–æ—Ç—É —Ñ—Ä–µ–π–º–∞
        })
        tween:Play()
        
        task.delay(20, function()
            if outputFrame.Visible then
                -- –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
                local hideTween = TweenService:Create(outputFrame, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                    Size = UDim2.new(0, 350, 0, 0),
                    Position = UDim2.new(0, 20, 1, -200)
                })
                hideTween:Play()
                hideTween.Completed:Wait()
                outputFrame.Visible = false
            end
        end)
    end

    -- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—ã–¥–≤–∏–∂–µ–Ω–∏—è/–∑–∞–¥–≤–∏–∂–µ–Ω–∏—è –∫–æ–Ω—Å–æ–ª–∏
    local function toggleInterface()
        if isExpanded then
            -- –ó–∞–¥–≤–∏–≥–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            local tween1 = TweenService:Create(TextBox, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Position = UDim2.new(0.5, -100, 1, -109),
                Size = UDim2.new(0, 0, 0, 43)
            })
            local tween2 = TweenService:Create(TextButton, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                Position = UDim2.new(0.5, 20, 1, -109),
                Size = UDim2.new(0, 0, 0, 43)
            })
            
            tween1:Play()
            tween2:Play()
            
            tween1.Completed:Connect(function()
                TextBox.Visible = false
                TextButton.Visible = false
            end)
        else
            -- –í—ã–¥–≤–∏–≥–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
            TextBox.Visible = true
            TextButton.Visible = true
            
            TextBox.Size = UDim2.new(0, 0, 0, 43)
            TextButton.Size = UDim2.new(0, 0, 0, 43)
            
            local tween1 = TweenService:Create(TextBox, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 180, 0, 43),
                Position = UDim2.new(0.5, -118, 1, -109)
            })
            local tween2 = TweenService:Create(TextButton, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 60, 0, 43),
                Position = UDim2.new(0.5, 58, 1, -109)
            })
            
            tween1:Play()
            tween2:Play()
        end
        
        isExpanded = not isExpanded
    end

    -- ==============================
    -- === FS AUTOFARM SYSTEM ===
    -- ==============================
    local FS_LOCATIONS = {
        rock = CFrame.new(409, 271, 978),
        crystal = CFrame.new(-2279, 1944, 1053),
        bluegod = CFrame.new(1176, 4789, -2293),
        greengod = CFrame.new(1381, 9274, 1647),
        redgod = CFrame.new(-369, 15735, -9)
    }

    local function teleportTo(cf)
        local char = plr.Character or plr.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart", 5)
        if hrp then
            hrp.CFrame = cf + Vector3.new(0, 3, 0)
        end
    end

    -- FS Autofarm variables
    local fsActive = false
    local fsLoopCoroutine = nil
    local fsConnections = {}
    local ATTACK_INTERVAL = 1.0
    local MAX_DISTANCE_FROM_POINT = 20
    local FIST_TOOL_NAME = "Fist Training"

    local FS_THRESHOLDS = {
        {name = "redgod",   min = 10 * 10^12},
        {name = "greengod", min = 100 * 10^9},
        {name = "bluegod",  min = 1 * 10^9},
        {name = "crystal",  min = 100000},
        {name = "rock",     min = 0}
    }

    local function getFistStrengthNumber()
        local txt = getFistStrengthText()
        return parseStatValue(txt)
    end

    local function equipFistTool()
        local function tryEquip(toolObj)
            if not toolObj then return false end
            local ok = pcall(function()
                toolObj.Parent = plr.Character
            end)
            return ok
        end

        local char = plr.Character
        if char then
            local tool = char:FindFirstChild(FIST_TOOL_NAME) or plr.Backpack:FindFirstChild(FIST_TOOL_NAME)
            if tool and tryEquip(tool) then return true end
        end

        local bp = plr:FindFirstChild("Backpack")
        if bp then
            local tool = bp:FindFirstChild(FIST_TOOL_NAME)
            if tool then
                return tryEquip(tool)
            end
        end

        return false
    end

    local function startFS()
        if fsActive then
            showOutput("FS: —É–∂–µ –≤–∫–ª—é—á—ë–Ω")
            return
        end
        fsActive = true
        showOutput("FS: –≤–∫–ª—é—á—ë–Ω.")

        local equipOk = equipFistTool()
        if not equipOk then
            showOutput("FS: –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: " .. FIST_TOOL_NAME)
            fsActive = false
            return
        end

        fsLoopCoroutine = task.spawn(function()
            while fsActive do
                local char = plr.Character
                local hrp = char and char:FindFirstChild("HumanoidRootPart")
                local humanoid = char and char:FindFirstChildOfClass("Humanoid")
                if not char or not hrp or (humanoid and humanoid.Health <= 0) then
                    task.wait(1)
                    continue
                end

                equipFistTool()

                pcall(function()
                    VirtualUser:CaptureController()
                    VirtualUser:Button1Down(Vector2.new(0,0))
                    task.wait(0.05)
                    VirtualUser:Button1Up(Vector2.new(0,0))
                end)

                local charHrpart = (plr.Character and plr.Character:FindFirstChild("HumanoidRootPart"))
                if charHrpart and zoneCFrame then
                    local dist = (charHrpart.Position - zoneCFrame.Position).Magnitude
                    if dist > MAX_DISTANCE_FROM_POINT then
                        safeTeleportTo(zoneCFrame)
                        equipFistTool()
                        showOutput("FS: –æ—Ç–∫–∏–Ω—É–ª–∏ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞—é—Å—å –Ω–∞ " .. zoneName)
                    end
                end

                task.wait(ATTACK_INTERVAL)
            end
        end)
    end

    local function stopFS()
        if not fsActive then
            showOutput("FS: —É–∂–µ –≤—ã–∫–ª—é—á–µ–Ω")
            return
        end
        fsActive = false
        showOutput("FS: –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        for _, conn in ipairs(fsConnections) do
            if conn and conn.Disconnect then
                pcall(function() conn:Disconnect() end)
            end
        end
        fsConnections = {}
        fsLoopCoroutine = nil
    end

    -- ==============================
    -- === AUTOTP SYSTEM ===
    -- ==============================
    local autotpActive = false
    local autotpConnections = {}
    local positionTrackerConn = nil
    local lastGroundPosition = nil

    local function startPositionTracker()
        if positionTrackerConn then return end
        positionTrackerConn = RunService.Heartbeat:Connect(function()
            local char = plr.Character
            if not char then return end
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            local hrp = char:FindFirstChild("HumanoidRootPart")
            if humanoid and hrp then
                local floor = humanoid.FloorMaterial
                if floor and floor ~= Enum.Material.Air then
                    lastGroundPosition = hrp.Position
                end
            end
        end)
    end

    local function stopPositionTracker()
        if positionTrackerConn then
            pcall(function() positionTrackerConn:Disconnect() end)
            positionTrackerConn = nil
        end
    end

    local function clearAutotpConnections()
        for _, c in ipairs(autotpConnections) do
            pcall(function() c:Disconnect() end)
        end
        autotpConnections = {}
    end

    local function cleanupVisuals()
        pcall(function()
            Lighting.Blur.Enabled = false
            if plr.PlayerGui:FindFirstChild("IntroGui") then
                plr.PlayerGui.IntroGui.Enabled = false
            end
            if plr.PlayerGui:FindFirstChild("ScreenGui") then
                plr.PlayerGui.ScreenGui.Enabled = true
            end
        end)
    end

    local function handleRespawnRecovery()
        showOutput("AUTOTP: –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—Å–ø–∞–≤–Ω–∞...")
        repeat task.wait(0.3) until plr.Character and plr.Character:FindFirstChild("Humanoid")
        task.wait(0.5)

        if fsActive then
            local zoneName, zoneCFrame = chooseFSLocation()
            if not zoneCFrame then
                zoneCFrame = FS_LOCATIONS["rock"]
                zoneName = "rock"
            end

            if zoneCFrame then
                pcall(function()
                    equipFistTool()
                    safeTeleportTo(zoneCFrame)
                    startFS()
                    showOutput("AUTOTP: –≤–µ—Ä–Ω—É–ª—Å—è –Ω–∞ FS-–∑–æ–Ω—É: " .. tostring(zoneName))
                end)
            else
                showOutput("AUTOTP: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å FS-–∑–æ–Ω—É")
            end
        else
            if lastGroundPosition then
                pcall(function()
                    local cf = CFrame.new(lastGroundPosition + Vector3.new(0,3,0))
                    safeTeleportTo(cf)
                    showOutput("AUTOTP: –≤–æ–∑–≤—Ä–∞—â–∞—é—Å—å –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∑–∏—Ü–∏–∏")
                end)
            else
                showOutput("AUTOTP: –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏")
            end
        end
        cleanupVisuals()
    end

    local function attachCharacterHandlers(char)
        if not char then return end
        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if not humanoid then
            humanoid = char:WaitForChild("Humanoid", 5)
        end
        if humanoid then
            local conn = humanoid.Died:Connect(function()
                pcall(function()
                    if ReplicatedStorage and ReplicatedStorage:FindFirstChild("RemoteEvent") then
                        pcall(function() ReplicatedStorage.RemoteEvent:FireServer({[1] = "Respawn"}) end)
                    end
                end)
                task.spawn(function()
                    task.wait(2.6)
                    handleRespawnRecovery()
                end)
            end)
            table.insert(autotpConnections, conn)
        end
    end

    local characterAddedConn = nil
    local function ensureCharacterAddedHandler()
        if characterAddedConn then return end
        characterAddedConn = plr.CharacterAdded:Connect(function(char)
            attachCharacterHandlers(char)
        end)
        table.insert(autotpConnections, characterAddedConn)
        if plr.Character then
            attachCharacterHandlers(plr.Character)
        end
    end

    local function startAutotp()
        if autotpActive then
            showOutput("AUTOTP: —É–∂–µ –≤–∫–ª—é—á—ë–Ω")
            return
        end
        autotpActive = true
        showOutput("AUTOTP: –≤–∫–ª—é—á—ë–Ω")

        startPositionTracker()
        ensureCharacterAddedHandler()

        if fsActive then
            pcall(function()
                equipFistTool()
                local zoneName, zoneCFrame = chooseFSLocation()
                if zoneCFrame then safeTeleportTo(zoneCFrame) end
            end)
        end
    end

    local function stopAutotp()
        if not autotpActive then
            showOutput("AUTOTP: —É–∂–µ –≤—ã–∫–ª—é—á–µ–Ω")
            return
        end
        autotpActive = false
        showOutput("AUTOTP: –æ—Ç–∫–ª—é—á—ë–Ω")
        clearAutotpConnections()
        stopPositionTracker()
    end

    -- ==============================
    -- === BT AUTOTRAIN SYSTEM ===
    -- ==============================
    local btActive = false
    local btLoopCoroutine = nil
    local BT_CHECK_INTERVAL = 1.0
    local BT_MAX_DISTANCE = 25

    local BODY_TOUGHNESS_LOCATIONS = {
        {threshold = 5,                cf = CFrame.new(365, 249, -445)},
        {threshold = 500,              cf = CFrame.new(349, 263, -490)},
        {threshold = 5000,             cf = CFrame.new(1640, 258, 2244)},
        {threshold = 50000,            cf = CFrame.new(-2307, 976, 1068)},
        {threshold = 500000,           cf = CFrame.new(-2024, 714, -1860)},
        {threshold = 50000000,         cf = CFrame.new(-254, 286, 980)},
        {threshold = 5000000000,       cf = CFrame.new(-271, 279, 991)},
        {threshold = 500000000000,     cf = CFrame.new(-279, 279, 1007)}
    }

    local function getBT()
        local ok, txt = pcall(function()
            return plr.PlayerGui.ScreenGui.MenuFrame.InfoFrame.BTTxt.Text
        end)
        if ok and txt then
            local val = txt:match(":%s*(.+)$") or txt
            return parseStatValue(val)
        end
        return 0
    end

    local function chooseBTZone()
        local bt = getBT()
        local chosen = BODY_TOUGHNESS_LOCATIONS[1].cf
        for _, z in ipairs(BODY_TOUGHNESS_LOCATIONS) do
            if bt >= z.threshold then
                chosen = z.cf
            else
                break
            end
        end
        return chosen
    end

    local function startBT()
        if btActive then
            showOutput("BT: —É–∂–µ –≤–∫–ª—é—á—ë–Ω")
            return
        end

        if fsActive then
            stopFS()
            showOutput("FS: –æ—Ç–∫–ª—é—á—ë–Ω (BT –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω)")
        end

        btActive = true
        local zone = chooseBTZone()
        safeTeleportTo(zone)
        showOutput("BT: –≤–∫–ª—é—á—ë–Ω –∏ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω")

        btLoopCoroutine = task.spawn(function()
            while btActive do
                local char = plr.Character
                if char and char:FindFirstChild("HumanoidRootPart") then
                    local hrp = char.HumanoidRootPart
                    local dist = (hrp.Position - zone.Position).Magnitude
                    if dist > BT_MAX_DISTANCE then
                        safeTeleportTo(zone)
                    end
                end
                task.wait(BT_CHECK_INTERVAL)
            end
        end)
    end

    local function stopBT()
        if not btActive then
            showOutput("BT: —É–∂–µ –≤—ã–∫–ª—é—á–µ–Ω")
            return
        end
        btActive = false
        showOutput("BT: –≤—ã–∫–ª—é—á–µ–Ω")
    end

    -- –°–æ–∑–¥–∞–µ–º –ø–∞–Ω–µ–ª–∏
    local statsPanel = createStatsGUI()
    local progressPanel = createProgressGUI()
    local ESPSystem = createESPSystem()
    local wikiSystem = createWikiSystem()

    -- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥
    local function handleCommand(message)
        local command = string.lower(message)
        
        if command == "help" then
            outputFrame.Size = UDim2.new(0, 350, 0, 900)
            showOutput("üìö –î–û–°–¢–£–ü–ù–´–ï –ö–û–ú–ê–ù–î–´:\n\nüìä –û—Å–Ω–æ–≤–Ω—ã–µ:\nstats - –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É\nts - –Ω–∞—á–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ\ntss - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ\ntsg - –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞\nclear - –æ—á–∏—Å—Ç–∏—Ç—å –≤—ã–≤–æ–¥\n\nüëä FS –ê–≤—Ç–æ—Ñ–∞—Ä–º:\nfs on - –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ñ–∞—Ä–º FS\nfs off - –≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ñ–∞—Ä–º FS\nrock - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ Rock\ncrystal - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ Crystal\nbluegod - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ Blue God Star\ngreengod - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ Green God Star\nredgod - —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ Red God Star\n\nüõ°Ô∏è BT –ê–≤—Ç–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:\nbt on - –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É BT\nbt off - –≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É BT\n\n‚ö° –ê–≤—Ç–æ-—Å–∏—Å—Ç–µ–º—ã:\nautotp on - –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-–≤–æ–∑–≤—Ä–∞—Ç\nautotp off - –≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ-–≤–æ–∑–≤—Ä–∞—Ç\n\nüëÅÔ∏è ESP –∫–æ–º–∞–Ω–¥—ã:\nesp on - –≤–∫–ª—é—á–∏—Ç—å ESP\nesp off - –≤—ã–∫–ª—é—á–∏—Ç—å ESP\nesp toggle - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å ESP\nplayers - —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤\ntp @–ò–º—è - —Ç–µ–ª–µ–ø–æ—Ä—Ç –∫ –∏–≥—Ä–æ–∫—É")

         -- ESP –∫–æ–º–∞–Ω–¥—ã
        elseif command == "esp on" then
            ESPSystem.enable()
            showOutput("üëÅÔ∏è ESP: –≤–∫–ª—é—á–µ–Ω")
        
        elseif command == "esp off" then
            ESPSystem.disable()
            showOutput("üëÅÔ∏è ESP: –≤—ã–∫–ª—é—á–µ–Ω")
        
        elseif command == "esp toggle" then
            ESPSystem.toggle()
        
        elseif command == "players" then
            outputFrame.Size = UDim2.new(0, 350, 0, 900)
            showOutput(ESPSystem.getPlayerList())
        
        elseif string.sub(command, 1, 4) == "tp @" then
            local playerName = string.sub(command, 5)
            if playerName and playerName ~= "" then
                ESPSystem.teleportToPlayerByName(playerName)
            else
                showOutput("‚ùå –£–∫–∞–∂–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞: tp @–ò–º—è–ò–≥—Ä–æ–∫–∞")
            end

        -- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        elseif command == "stats" then
            statsPanel.toggle()
            showOutput("üìä –û—Ç–∫—Ä—ã–≤–∞—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...")
        
        elseif command == "ts" then
            progressPanel.startTracking()
            showOutput("üìà –ù–∞—á–∞–ª–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞")
        
        elseif command == "tss" then
            progressPanel.stopTracking()
            showOutput("üìâ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è")
        
        elseif command == "tsg" then
            progressPanel.toggle()
            showOutput("üìä –û—Ç–∫—Ä—ã–≤–∞—é –ø–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞")
        
        elseif command == "clear" then
            outputLabel.Text = ""
            showOutput("üßπ –í—ã–≤–æ–¥ –æ—á–∏—â–µ–Ω")
            
        elseif command == "wiki" then
            wikiSystem.toggle()
            showOutput("üìö Wiki: " .. (wikiSystem.gui.MainFrame.Visible and "–æ—Ç–∫—Ä—ã—Ç–∞" or "–∑–∞–∫—Ä—ã—Ç–∞"))

        -- FS –∫–æ–º–∞–Ω–¥—ã
        elseif command == "fs on" then
            startFS()
        
        elseif command == "fs off" then
            stopFS()

        -- –¢–µ–ª–µ–ø–æ—Ä—Ç—ã FS
        elseif FS_LOCATIONS[command] then
            teleportTo(FS_LOCATIONS[command])
            showOutput("üîÑ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è: " .. command)

        -- BT –∫–æ–º–∞–Ω–¥—ã
        elseif command == "bt on" then
            startBT()
        
        elseif command == "bt off" then
            stopBT()

        -- AUTOTP –∫–æ–º–∞–Ω–¥—ã
        elseif command == "autotp on" then
            startAutotp()
        
        elseif command == "autotp off" then
            stopAutotp()
        
        else
            showOutput("‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: " .. command .. "\n–í–≤–µ–¥–∏—Ç–µ 'help' –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.")
        end
        
        -- –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        table.insert(history, message)
        historyIndex = #history + 1
    end

    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–≤–æ–¥–∞
    TextButton.MouseButton1Click:Connect(function()
        local message = TextBox.Text
        if message ~= "" then
            handleCommand(message)
            TextBox.Text = ""
        end
    end)

    TextBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            local message = TextBox.Text
            if message ~= "" then
                handleCommand(message)
            end
            TextBox.Text = ""
        end
    end)

    -- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
    UIS.InputBegan:Connect(function(input, processed)
        if processed then return end
        
        if input.KeyCode == Enum.KeyCode.F2 then
            toggleInterface()
            if isExpanded then
                TextBox:CaptureFocus()
            end
        elseif input.KeyCode == Enum.KeyCode.Escape then
            if isExpanded then
                toggleInterface()
            end
        end
    end)

    return consoleGui
end


-- ==============================
-- === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã ===
-- ==============================
local statsPanel = createStatsGUI()
local progressPanel = createProgressGUI()
local commandConsole = createCommandConsole()

-- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
local UIS = game:GetService("UserInputService")
UIS.InputBegan:Connect(function(input, processed)
    if processed then return end
    
    if input.KeyCode == Enum.KeyCode.RightShift then
        pcall(function() statsPanel.toggle() end)
    elseif input.KeyCode == Enum.KeyCode.RightControl then
        pcall(function() progressPanel.toggle() end)
    end
end)
